<!DOCTYPE html><html lang=en itemscope itemtype=http://schema.org/TechArticle><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=google-site-verification content=YaLDO6PjDQSpDh7kvHyEvOYPOc4rkERmW5VCftmVp6c><meta name=viewport content="width=device-width,initial-scale=1,minimum-scale=1"><meta name=theme-color content=#FF9900><meta name=author itemprop=author content="Vitaliy Zasadnyy"><meta name=keywords itemprop=keywords content="android, maven, eclipse"><meta itemprop=image content=http://v.zasadnyy.com/img/posts/abs-maven-eclipse-integration/eclipse-maven-abs.png><meta name=twitter:card content=summary><meta name=twitter:site content=@zasadnyy><meta name=twitter:title content="Action Bar Sherlock, Maven, Eclipse integration &#8226; Vitaliy Zasadnyy"><meta name=twitter:description content="

Hello, today I’d like to describe a process of integration commonly used library for emulation action bar in old Android versions - ActionBarSher..."><meta name=twitter:image:src content=http://v.zasadnyy.com/img/posts/abs-maven-eclipse-integration/eclipse-maven-abs.png><meta property=og:title content="Action Bar Sherlock, Maven, Eclipse integration &#8226; Vitaliy Zasadnyy"><meta property=og:site_name content="Vitaliy Zasadnyy"><meta property=og:type content=article><meta property=og:url content=http://v.zasadnyy.com/blog/abs-maven-eclipse-integration><meta property=og:description content="

Hello, today I’d like to describe a process of integration commonly used library for emulation action bar in old Android versions - ActionBarSher..."><meta property=og:image content=http://v.zasadnyy.com/img/posts/abs-maven-eclipse-integration/eclipse-maven-abs.png><link rel=canonical itemprop=url href=http://v.zasadnyy.com/blog/abs-maven-eclipse-integration><link rel=alternate type=application/rss+xml title=RSS href=/feed.xml><title>Action Bar Sherlock, Maven, Eclipse integration &#8226; Vitaliy Zasadnyy</title><link rel="shortcut icon" href=http://v.zasadnyy.com/img/favicons/favicon.ico><link rel=apple-touch-icon sizes=152x152 href=http://v.zasadnyy.com/img/favicons/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=144x144 href=http://v.zasadnyy.com/img/favicons/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=120x120 href=http://v.zasadnyy.com/img/favicons/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=114x114 href=http://v.zasadnyy.com/img/favicons/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=76x76 href=http://v.zasadnyy.com/img/favicons/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=72x72 href=http://v.zasadnyy.com/img/favicons/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=60x60 href=http://v.zasadnyy.com/img/favicons/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=57x57 href=http://v.zasadnyy.com/img/favicons/apple-touch-icon-57x57.png><link rel=icon type=image/png href=http://v.zasadnyy.com/img/favicons/favicon-196x196.png><link rel=icon type=image/png href=http://v.zasadnyy.com/img/favicons/favicon-160x160.png><link rel=icon type=image/png href=http://v.zasadnyy.com/img/favicons/favicon-96x96.png><link rel=icon type=image/png href=http://v.zasadnyy.com/img/favicons/favicon-32x32.png><link rel=icon type=image/png href=http://v.zasadnyy.com/img/favicons/favicon-16x16.png><meta name=msapplication-TileColor content=#2b5797><meta name=msapplication-TileImage content=http://v.zasadnyy.com/img/favicons/mstile-144x144.png><meta name=msapplication-config content=http://v.zasadnyy.com/img/favicons/browserconfig.xml><style type=text/css></style><link rel=preload type=text/css href=/css/blog.css as=style onload="this.rel=&quot;stylesheet&quot;"><noscript><link rel="stylesheet" type="text/css" href="/css/blog.css"></noscript><!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script><![endif]--></head><body><div class=container><header class=header><a class=logo-header href="/"><img src=/img/logo.svg alt="Vitaliy Zasadnyy" height=100px width=102px></a><nav class=nav><ul><li><a class="nav-link current" href="/">Blog</a></li><li><a class=nav-link href="/talks/">Talks</a></li><li><a class=nav-link href="/projects/">Projects</a></li></ul></nav></header></div><div class="article-header container-fluid"><div class=container><h1 class=article-title itemprop=name>Action Bar Sherlock, Maven, Eclipse integration</h1><div class=row><div class=col-md-7><p class=article-description itemprop=headline>Step by step guide</p><meta name=description itemprop=description content="

Hello, today I’d like to describe a process of integration commonly used library for emulation action bar in old Android versions - ActionBarSher..."></div></div></div></div><div class=container><div class=row><div class="article-meta col-md-5 col-xs-12"><ul><li><span class=name>Date published:</span> <span class=value itemprop=datePublished content=" 2012-11-04 ">November 4, 2012</span></li><li><span class=name>Est. Read Time:</span> <span class=value>10 mins</span></li><li><span class=name>Share with:</span> <span class=value><a href=# onclick="return window.open(&quot;https://plus.google.com/share?url=http://v.zasadnyy.com/blog/abs-maven-eclipse-integration&quot;,&quot;newwindow&quot;,&quot;width=600, height=500&quot;),!1">Google+</a></span> <span>&#8226;</span> <span class=value><a href=# onclick="return window.open(&quot;https://twitter.com/home?status=http://v.zasadnyy.com/blog/abs-maven-eclipse-integration&quot;,&quot;newwindow&quot;,&quot;width=600, height=250&quot;),!1">Twitter</a></span> <span>&#8226;</span> <span class=value><a href=# onclick="return window.open(&quot;https://www.facebook.com/sharer/sharer.php?u=http://v.zasadnyy.com/blog/abs-maven-eclipse-integration&quot;,&quot;newwindow&quot;,&quot;width=600, height=500&quot;),!1">Facebook</a></span></li><li><span class=name>Tags:</span> <span class=value><a class=category href=/blog/tag/android>#android</a>, <a class=category href=/blog/tag/maven>#maven</a>, <a class=category href=/blog/tag/eclipse>#eclipse</a></span></li></ul></div><article class="article col-md-9" itemprop=articleBody><p><img src=/img/posts/abs-maven-eclipse-integration/eclipse-maven-abs.png alt=image></p><p>Hello, today I’d like to describe a process of integration commonly used library for emulation action bar in old Android versions - <a href="http://actionbarsherlock.com/">ActionBarSherlock</a> into maven - Eclipse project. In a result we’ll get a project with:</p><ul><li>support of Action Bar Sherlock</li><li>support of integration tests as a separate project</li><li>configured Maven build and release targets</li><li>configured Eclipse for develop and debug</li></ul><p>This is my first post, so don’t be too critical :)</p><p>At first let’s create empty Android mvn project. In order to complete this step we’ll need:</p><ul><li><a href=http://www.oracle.com/technetwork/java/javase/downloads/jdk7u9-downloads-1859576.html>JDK 1.6+</a> installed as required for Android development</li><li><a href=http://developer.android.com/intl/ru/sdk/index.html>Android SDK</a> installed r17+ , preferably with all platforms</li><li><a href=http://maven.apache.org/download.html>Maven 3.0.3+</a> installed</li></ul><p>If you use Eclipse for development, you’ll also need:</p><ul><li>Eclipse with <a href="http://eclipse.org/m2e/">m2e</a> plugin installed</li></ul><p>At first let’s create Android project using akquinet <a href=https://github.com/akquinet/android-archetypes>android-archetypes</a>. In a result, we’ll get a sample project with configured release targets and integration tests project. Copy following code to the terminal, replacing highligted lines with your values:</p><figure class=code-highlight-figure><div class=code-highlight><pre class=code-highlight-pre><div data-line=1 class="code-highlight-row numbered"><div class=code-highlight-line>mvn archetype:generate <span class=se>\</span>
</div></div><div data-line=2 class="code-highlight-row numbered"><div class=code-highlight-line> -DarchetypeArtifactId<span class=o>=</span>android-release <span class=se>\</span>
</div></div><div data-line=3 class="code-highlight-row numbered"><div class=code-highlight-line> -DarchetypeGroupId<span class=o>=</span>de.akquinet.android.archetypes <span class=se>\</span>
</div></div><div data-line=4 class="code-highlight-row numbered"><div class=code-highlight-line> -DarchetypeVersion<span class=o>=</span>1.0.8 <span class=se>\</span>
</div></div><div data-line=5 class="code-highlight-row numbered marked-line start-marked-line"><div class=code-highlight-line> -DgroupId<span class=o>=</span>com.foo.bar <span class=se>\</span>
</div></div><div data-line=6 class="code-highlight-row numbered marked-line"><div class=code-highlight-line> -DartifactId<span class=o>=</span>my-android-project <span class=se>\</span>
</div></div><div data-line=7 class="code-highlight-row numbered marked-line end-marked-line"><div class=code-highlight-line> -Dpackage<span class=o>=</span>com.foo.bar.test <span class=se>\</span>
</div></div><div data-line=8 class="code-highlight-row numbered"><div class=code-highlight-line> -Dplatform<span class=o>=</span>16</div></div></pre></div></figure><p>Once generated, the application is ready to be built and tested. Start an Android emulator, or plug an Android dev phone, and execute:</p><figure class=code-highlight-figure><div class=code-highlight><pre class=code-highlight-pre><div data-line=1 class="code-highlight-row numbered"><div class=code-highlight-line><span class=nb>cd </span>my-android-project
</div></div><div data-line=2 class="code-highlight-row numbered"><div class=code-highlight-line>mvn clean install</div></div></pre></div></figure><p>Besides your application, this commands will also install and execute integrations tests application.</p><p>Generated project goes with test keystore that could be used for test, but not for deploying to market, run this command to get signed apk:</p><figure class=code-highlight-figure><div class=code-highlight><pre class=code-highlight-pre><div data-line=1 class="code-highlight-row numbered"><div class=code-highlight-line>mvn clean install -Prelease <span class=se>\</span>
</div></div><div data-line=2 class="code-highlight-row numbered"><div class=code-highlight-line>-Dsign.keystore<span class=o>=</span>PATH_OF_THE_PROJECT/my-android-project/test-key.keystore <span class=se>\</span>
</div></div><div data-line=3 class="code-highlight-row numbered"><div class=code-highlight-line>-Dsign.alias<span class=o>=</span>mykey <span class=se>\</span>
</div></div><div data-line=4 class="code-highlight-row numbered"><div class=code-highlight-line>-Dsign.storepass<span class=o>=</span>testtest <span class=se>\</span>
</div></div><div data-line=5 class="code-highlight-row numbered"><div class=code-highlight-line>-Dsign.keypass<span class=o>=</span>testtest</div></div></pre></div></figure><p>Now we need to download and add to our project dependencies <a href="http://actionbarsherlock.com/">ActionbarBarSherlock</a>.</p><p>Latest version of the library always is available in the project <a href=http://actionbarsherlock.com/download.html>download page</a>. When it’s ready, unzip archive, copy <code>library</code> folder to your project root and rename it to <code>actionbarsherlock</code>:</p><p><img src=/img/posts/abs-maven-eclipse-integration/my-android-project-1.png alt=image></p><p>As it is stated on <a href=http://actionbarsherlock.com/usage.html>abs usage page</a> the only thing we need - is to add this lines to <code>my-android-project/my-android-project/pom.xml</code> :</p><figure class=code-highlight-figure><div class=code-highlight><pre class=code-highlight-pre><div data-line=1 class="code-highlight-row numbered"><div class=code-highlight-line><span class=nt>&lt;dependency&gt;</span>
</div></div><div data-line=2 class="code-highlight-row numbered"><div class=code-highlight-line>    <span class=nt>&lt;groupId&gt;</span>com.actionbarsherlock<span class=nt>&lt;/groupId&gt;</span>
</div></div><div data-line=3 class="code-highlight-row numbered"><div class=code-highlight-line>    <span class=nt>&lt;artifactId&gt;</span>actionbarsherlock<span class=nt>&lt;/artifactId&gt;</span>
</div></div><div data-line=4 class="code-highlight-row numbered"><div class=code-highlight-line>    <span class=nt>&lt;version&gt;</span>4.2.0<span class=nt>&lt;/version&gt;</span>
</div></div><div data-line=5 class="code-highlight-row numbered"><div class=code-highlight-line>    <span class=nt>&lt;type&gt;</span>apklib<span class=nt>&lt;/type&gt;</span>
</div></div><div data-line=6 class="code-highlight-row numbered"><div class=code-highlight-line><span class=nt>&lt;/dependency&gt;</span></div></div></pre></div></figure><p>Also you need to extend <code>HelloAndroidActivity</code> from <code>com.actionbarsherlock.app.SherlockActivity</code> instead of <code>android.app.Activity</code> and change activity theme in <code>AndroidManifest.xml</code> to <code>android:theme="@style/Theme.Sherlock"</code>. Checkout <a href=/files/posts/patch.diff>git patch file</a> for details. Try to build app. From parent project folder execute:</p><figure class=code-highlight-figure><div class=code-highlight><pre class=code-highlight-pre><div data-line=1 class="code-highlight-row numbered"><div class=code-highlight-line>mvn clean install</div></div></pre></div></figure><p>You’ll get following error:</p><figure class=code-highlight-figure><div class=code-highlight><pre class=code-highlight-pre><div data-line=1 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] UNEXPECTED TOP-LEVEL EXCEPTION:
</div></div><div data-line=2 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] java.lang.IllegalArgumentException: already added: Landroid/support/v4/app/Watson<span class=nv>$OnCreateOptionsMenuListener</span>;
</div></div><div data-line=3 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.dex.file.ClassDefsSection.add<span class=o>(</span>ClassDefsSection.java:123<span class=o>)</span>
</div></div><div data-line=4 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.dex.file.DexFile.add<span class=o>(</span>DexFile.java:163<span class=o>)</span>
</div></div><div data-line=5 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.command.dexer.Main.processClass<span class=o>(</span>Main.java:486<span class=o>)</span>
</div></div><div data-line=6 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.command.dexer.Main.processFileBytes<span class=o>(</span>Main.java:455<span class=o>)</span>
</div></div><div data-line=7 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.command.dexer.Main.access<span class=nv>$400</span><span class=o>(</span>Main.java:67<span class=o>)</span>
</div></div><div data-line=8 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.command.dexer.Main<span class=nv>$1</span>.processFileBytes<span class=o>(</span>Main.java:394<span class=o>)</span>
</div></div><div data-line=9 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.cf.direct.ClassPathOpener.processArchive<span class=o>(</span>ClassPathOpener.java:245<span class=o>)</span>
</div></div><div data-line=10 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.cf.direct.ClassPathOpener.processOne<span class=o>(</span>ClassPathOpener.java:131<span class=o>)</span>
</div></div><div data-line=11 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.cf.direct.ClassPathOpener.process<span class=o>(</span>ClassPathOpener.java:109<span class=o>)</span>
</div></div><div data-line=12 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.command.dexer.Main.processOne<span class=o>(</span>Main.java:418<span class=o>)</span>
</div></div><div data-line=13 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.command.dexer.Main.processAllFiles<span class=o>(</span>Main.java:329<span class=o>)</span>
</div></div><div data-line=14 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.command.dexer.Main.run<span class=o>(</span>Main.java:206<span class=o>)</span>
</div></div><div data-line=15 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.command.dexer.Main.main<span class=o>(</span>Main.java:174<span class=o>)</span>
</div></div><div data-line=16 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]  at com.android.dx.command.Main.main<span class=o>(</span>Main.java:91<span class=o>)</span>
</div></div><div data-line=17 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] 1 error; aborting
</div></div><div data-line=18 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] ------------------------------------------------------------------------
</div></div><div data-line=19 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] Reactor Summary:
</div></div><div data-line=20 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO]
</div></div><div data-line=21 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] my-android-project - Parent ....................... SUCCESS <span class=o>[</span>0.394s]
</div></div><div data-line=22 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] my-android-project - Application .................. SUCCESS <span class=o>[</span>14.880s]
</div></div><div data-line=23 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] my-android-project-it - Integration tests ......... FAILURE <span class=o>[</span>9.501s]
</div></div><div data-line=24 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] ------------------------------------------------------------------------
</div></div><div data-line=25 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] BUILD FAILURE
</div></div><div data-line=26 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] ------------------------------------------------------------------------
</div></div><div data-line=27 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] Total <span class=nb>time</span>: 21.255s
</div></div><div data-line=28 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] Finished at: Sun Nov 04 12:50:51 GMT+02:00 2012
</div></div><div data-line=29 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] Final Memory: 15M/81M
</div></div><div data-line=30 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>INFO] ------------------------------------------------------------------------
</div></div><div data-line=31 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>ERROR] Failed to execute goal com.jayway.maven.plugins.android.generation2:android-maven-plugin:3.1.1:dex <span class=o>(</span>default-dex<span class=o>)</span> on project my-android-project-it: MojoExecutionException: ANDROID-040-001: Could not execute: Command <span class=o>=</span> /bin/sh -c <span class=nb>cd</span> /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project-it <span class=o>&amp;&amp;</span> /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/bin/java -Xmx1024M -jar /Users/vitaliyzasadnyy/Development/SDKs/android-sdk-macosx/platform-tools/lib/dx.jar --dex --output<span class=o>=</span>/Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project-it/target/classes.dex /Users/vitaliyzasadnyy/.m2/repository/com/actionbarsherlock/actionbarsherlock/4.2.0/actionbarsherlock-4.2.0.apklib /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project/target/my-android-project-1.0-SNAPSHOT.jar /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project-it/target/classes /Users/vitaliyzasadnyy/.m2/repository/de/akquinet/android/androlog/androlog/1.0.5/androlog-1.0.5.jar /Users/vitaliyzasadnyy/.m2/repository/com/google/android/support-v4/r7/support-v4-r7.jar, Result <span class=o>=</span> 1 -&gt; <span class=o>[</span>Help 1]</div></div></pre></div></figure><p>If you carefully take a look at the last error, you’ll notice that a problem is with <code>generation2</code> goal. It uses dex tool from Android SDK to generate class files for Dalvik. During the execution, it includes <code>actionbarsherlock</code> and <code>support-v4-r7</code> dependencies two times (second time like transitive dependency from our application project). Check out it <code>--output</code> parameter values (here is a bit formatted text from maven error):</p><figure class=code-highlight-figure><div class=code-highlight><pre class=code-highlight-pre><div data-line=1 class="code-highlight-row numbered"><div class=code-highlight-line>/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/bin/java -Xmx1024M -jar /Users/vitaliyzasadnyy/Development/SDKs/android-sdk-macosx/platform-tools/lib/dx.jar --dex --output<span class=o>=</span>
</div></div><div data-line=2 class="code-highlight-row numbered"><div class=code-highlight-line>    /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project-it/target/classes.dex
</div></div><div data-line=3 class="code-highlight-row numbered marked-line start-marked-line end-marked-line"><div class=code-highlight-line>    /Users/vitaliyzasadnyy/.m2/repository/com/actionbarsherlock/actionbarsherlock/4.2.0/actionbarsherlock-4.2.0.apklib
</div></div><div data-line=4 class="code-highlight-row numbered"><div class=code-highlight-line>    /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project/target/my-android-project-1.0-SNAPSHOT.jar
</div></div><div data-line=5 class="code-highlight-row numbered"><div class=code-highlight-line>    /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project-it/target/classes
</div></div><div data-line=6 class="code-highlight-row numbered"><div class=code-highlight-line>    /Users/vitaliyzasadnyy/.m2/repository/de/akquinet/android/androlog/androlog/1.0.5/androlog-1.0.5.jar
</div></div><div data-line=7 class="code-highlight-row numbered marked-line start-marked-line end-marked-line"><div class=code-highlight-line>    /Users/vitaliyzasadnyy/.m2/repository/com/google/android/support-v4/r7/support-v4-r7.jar</div></div></pre></div></figure><p>We can fix this error by adding <code>actionbarsherlock</code> and <code>support-v4-r7</code> dependencies with scope provided to <code>my-android-project-it/pom.xml</code>:</p><figure class=code-highlight-figure><div class=code-highlight><pre class=code-highlight-pre><div data-line=1 class="code-highlight-row numbered"><div class=code-highlight-line><span class=nt>&lt;dependency&gt;</span>
</div></div><div data-line=2 class="code-highlight-row numbered"><div class=code-highlight-line>    <span class=nt>&lt;groupId&gt;</span>com.google.android<span class=nt>&lt;/groupId&gt;</span>
</div></div><div data-line=3 class="code-highlight-row numbered"><div class=code-highlight-line>    <span class=nt>&lt;artifactId&gt;</span>support-v4<span class=nt>&lt;/artifactId&gt;</span>
</div></div><div data-line=4 class="code-highlight-row numbered"><div class=code-highlight-line>    <span class=nt>&lt;version&gt;</span>r7<span class=nt>&lt;/version&gt;</span>
</div></div><div data-line=5 class="code-highlight-row numbered marked-line start-marked-line end-marked-line"><div class=code-highlight-line>    <span class=nt>&lt;scope&gt;</span>provided<span class=nt>&lt;/scope&gt;</span>
</div></div><div data-line=6 class="code-highlight-row numbered"><div class=code-highlight-line><span class=nt>&lt;/dependency&gt;</span>
</div></div><div data-line=7 class="code-highlight-row numbered"><div class=code-highlight-line> </div></div><div data-line=8 class="code-highlight-row numbered"><div class=code-highlight-line> <span class=nt>&lt;dependency&gt;</span>
</div></div><div data-line=9 class="code-highlight-row numbered"><div class=code-highlight-line>     <span class=nt>&lt;groupId&gt;</span>com.actionbarsherlock<span class=nt>&lt;/groupId&gt;</span>
</div></div><div data-line=10 class="code-highlight-row numbered"><div class=code-highlight-line>     <span class=nt>&lt;artifactId&gt;</span>actionbarsherlock<span class=nt>&lt;/artifactId&gt;</span>
</div></div><div data-line=11 class="code-highlight-row numbered"><div class=code-highlight-line>     <span class=nt>&lt;version&gt;</span>4.2.0<span class=nt>&lt;/version&gt;</span>
</div></div><div data-line=12 class="code-highlight-row numbered"><div class=code-highlight-line>     <span class=nt>&lt;type&gt;</span>apklib<span class=nt>&lt;/type&gt;</span>
</div></div><div data-line=13 class="code-highlight-row numbered marked-line start-marked-line end-marked-line"><div class=code-highlight-line>     <span class=nt>&lt;scope&gt;</span>provided<span class=nt>&lt;/scope&gt;</span>
</div></div><div data-line=14 class="code-highlight-row numbered"><div class=code-highlight-line><span class=nt>&lt;/dependency&gt;</span></div></div></pre></div></figure><p>Now project should build successfully.</p><p>Next step is to configurate eclipse. Rename parent folder of a project from <code>my-android-project</code> to <code>my-android-project-parent</code>.</p><p><img src=/img/posts/abs-maven-eclipse-integration/my-android-project-2.png alt=image></p><p>Open Eclipse, import <code>my-android-project-parent</code> using existing maven project wizard. As <code>actionbarsherlock</code> is not part of our parent maven project you’ll also need to import it as existing maven project (<u>don't</u> import it as Android library project!). After this steps you should have following project structure:</p><p><img src=/img/posts/abs-maven-eclipse-integration/eclipse-project-1.png alt=image></p><p>Let’s fix build path problems that we have.</p><ol><li>Go to <code>my-android-project</code> properties</li><li>Open Android section</li><li>Add <code>actionbarsherlock</code> as a library by pressing Add button</li><li>Now you should see <code>actionbarsherlock</code> in a library section</li></ol><p><img src=/img/posts/abs-maven-eclipse-integration/eclipse-project-2.png alt=image></p><p>As we are using separate project for integration test, we should remove <code>src/test/java</code> folder from <code>my-android-project</code> and <code>my-android-project-it</code> build path:</p><ol><li>Go to <code>my-android-project</code> (or <code>my-android-project-it</code>) properties</li><li>Open Java Build Path section</li><li>Under Sources tab select <code>src/test/java</code> folder</li><li>Press remove button</li></ol><p><img src=/img/posts/abs-maven-eclipse-integration/eclipse-project-3.png alt=image></p><p>Now all errors from Eclipse markers view should disappear, and we can run our project. Select <code>my-android-project</code> and run it as Android application… but you’ll get:</p><p><img src=/img/posts/abs-maven-eclipse-integration/eclipse-project-3-error.png alt=image></p><p>In console view, you’ll find an error like this one:</p><figure class=code-highlight-figure><div class=code-highlight><pre class=code-highlight-pre><div data-line=1 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>2012-11-04 14:22:26 - my-android-project] Conversion to Dalvik format failed with error 1
</div></div><div data-line=2 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>2012-11-04 14:23:55 - my-android-project] Dx
</div></div><div data-line=3 class="code-highlight-row numbered"><div class=code-highlight-line>UNEXPECTED TOP-LEVEL EXCEPTION:
</div></div><div data-line=4 class="code-highlight-row numbered"><div class=code-highlight-line>java.lang.IllegalArgumentException: already added: Lorg/hamcrest/BaseDescription;
</div></div><div data-line=5 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>2012-11-04 14:23:55 - my-android-project] Dx  at com.android.dx.dex.file.ClassDefsSection.add<span class=o>(</span>ClassDefsSection.java:123<span class=o>)</span>
</div></div><div data-line=6 class="code-highlight-row numbered"><div class=code-highlight-line><span class=o>[</span>2012-11-04 14:23:55 - my-android-project] Dx  at com.android.dx.dex.file.DexFile.add<span class=o>(</span>DexFile.java:163<span class=o>)</span></div></div></pre></div></figure><p>Remember our problem with maven configuration? Here we have quite the same issue with double inclusion. In order to fix it remove libs folder with <code>android-support-v4.jar</code> from <code>actionbarsherlock</code> project.</p><p><img src=/img/posts/abs-maven-eclipse-integration/eclipse-project-4.png alt=image></p><p>Finally, clean all projects and run <code>my-android-project</code>. We’ve got working application:</p><p><img src=/img/posts/abs-maven-eclipse-integration/app-screenshot.png alt=image></p><p>Sample project from post you can <a href=/files/posts/abs-maven-eclipse-integration/my-android-project-parent.zip>download here</a>.</p><p>Hope this post was useful, if you have any notes or propositions how it can be improved, please write a comment.</p><hr>Share with: <span class=value><a href=# onclick="return window.open(&quot;https://plus.google.com/share?url=http://v.zasadnyy.com/blog/abs-maven-eclipse-integration&quot;,&quot;newwindow&quot;,&quot;width=600, height=500&quot;),!1">Google+</a></span> <span>&#8226;</span> <span class=value><a href=# onclick="return window.open(&quot;https://twitter.com/home?status=http://v.zasadnyy.com/blog/abs-maven-eclipse-integration&quot;,&quot;newwindow&quot;,&quot;width=600, height=250&quot;),!1">Twitter</a></span> <span>&#8226;</span> <span class=value><a href=# onclick="return window.open(&quot;https://www.facebook.com/sharer/sharer.php?u=http://v.zasadnyy.com/blog/abs-maven-eclipse-integration&quot;,&quot;newwindow&quot;,&quot;width=600, height=500&quot;),!1">Facebook</a></span></article><div class="post-switcher col-md-9"><div class=row><div class="switcher-item col-sm-6"><a href=/blog/cyrillic-app-name-incorrectly-encoded title="Cyrillic app name incorrectly encoded during porting Android app to Blackberry"><span class=arrow>←</span><p class=switcher-content>Cyrillic app name incorrectly encoded during porting Android app to Blackberry</p></a></div><div class="switcher-item col-sm-6"></div></div></div><div class="comments col-md-9"><div id=disqus_thread></div><script type=text/javascript>var disqus_shortname="vzasadnyy";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><script>!function(e){"use strict";var t=function(t,n,r){function o(){i.addEventListener&&i.removeEventListener("load",o),i.media=r||"all"}var a,l=e.document,i=l.createElement("link");if(n)a=n;else{var d=(l.body||l.getElementsByTagName("head")[0]).childNodes;a=d[d.length-1]}var s=l.styleSheets;i.rel="stylesheet",i.href=t,i.media="only x",function f(e){return l.body?e():void setTimeout(function(){f(e)})}(function(){a.parentNode.insertBefore(i,n?a:a.nextSibling)});var u=function(e){for(var t=i.href,n=s.length;n--;)if(s[n].href===t)return e();setTimeout(function(){u(e)})};return i.addEventListener&&i.addEventListener("load",o),(i.onloadcssdefined=u)(o),i};"undefined"!=typeof exports?exports.loadCSS=t:e.loadCSS=t}("undefined"!=typeof global?global:this),function(e){if(e.loadCSS){var t=loadCSS.relpreload={};if(t.support=function(){try{return e.document.createElement("link").relList.supports("preload")}catch(t){return!1}},t.poly=function(){for(var t=e.document.getElementsByTagName("link"),n=0;n<t.length;n++){var r=t[n];"preload"===r.rel&&"style"===r.getAttribute("as")&&(e.loadCSS(r.href,r,r.getAttribute("media")),r.rel=null)}},!t.support()){t.poly();var n=e.setInterval(t.poly,300);e.addEventListener&&e.addEventListener("load",function(){t.poly(),e.clearInterval(n)}),e.attachEvent&&e.attachEvent("onload",function(){e.clearInterval(n)})}}}(this);</script></div></div></div><div class="container-fluid footer-container"><footer class="footer container"><div class=row><div class="col-md-6 col-sm-7"><h4 class=hidden-xs>About</h4><div class="author-photo flow-img img-circle" style=background-image:url(/img/photo.jpg)></div><p class=author-about>Hi there, my name is Vitaliy, I'm product manager at <a href=https://getsocial.im target=_blank>GetSocial</a>. I've joined the company as a technical lead, but in the last years, moved to the product side of the development and developer advocacy.<br>Before joining GetSocial, I've spent 2.5 years leading the team of Unity 3D developers at <a href="http://nravo.com/" target=_blank>Nravo</a>, where had a chance to learn gaming industry from the inside.<br>During free time, you can find me preparing to the next speaking gig, or organizing <a href="https://devfest.gdg.org.ua/" target=_blank>DevFest Ukraine</a>, the biggest Google tech conference in CEE.</p></div><div class="get-in-touch col-md-4 col-sm-5 col-md-offset-1"><h4 class=hidden-xs>Get in touch</h4><p class=author-social>You can find me on <a href=https://www.linkedin.com/in/zasadnyy target=_blank>LinkedIn</a>, <a href=http://twitter.com/zasadnyy target=_blank>Twitter</a>, <a href=https://www.youtube.com/channel/UCZuD7FqMvpjr_onzMl3MnuQ target=_blank>YouTube</a> and <a href=https://speakerhub.com/user/7163 target=_blank>SpeakerHub</a>. If you want reach me directly, please send an <a href=mailto:vitaliy@zasadnyy.com target=_blank>email</a>.</p><p class=subscribe>Subscribe with <a href=/feed.xml>RSS</a>.</p></div><div class=clearfix></div><div class="license text-center col-md-12"><i>Except as otherwise noted, the content of this page is licensed under the Creative Commons Attribution 3.0 License, and code samples are licensed under the Apache 2.0 License.</i></div></div></footer></div><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-35774352-2","auto"),ga("send","pageview");</script><script type=text/javascript>WebFontConfig={google:{families:["Roboto:500,300:latin"]}},function(){var t=document.createElement("script");t.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",t.type="text/javascript",t.async="true";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}();</script></body></html>